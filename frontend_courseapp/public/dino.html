<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8" />
  <title>Bomb Jump</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
  width: 100vw;
  height: 100vh;
  overflow: hidden;
}

    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: #f4f4f4;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    h2 {
      margin-bottom: 10px;
    }

    #score {
      font-size: 18px;
      margin-bottom: 10px;
    }

    #game {
      position: relative;
      width: 100vw;     /* Širina 100% viewporta */
      height: 90vh;     /* Visina 80% viewporta */
      max-width: 1200px; /* maksimalna širina da ne bude preveliko */
      background-color: #e0e0e0;
      margin-bottom: 10px;
      border: 3px solid #444;
      overflow: hidden;
    }

    #player {
      width: 50px;
      height: 50px;
      background-image: url('/images/thief_15808415.png');
      background-size: cover;
      background-repeat: no-repeat;
      position: absolute;
      bottom: 0;
      left: 60px;
    }

    .obstacle {
      width: 30px;
      height: 30px;
      background-image: url('/images/bomb_16015917.png');
      background-size: cover;
      position: absolute;
      bottom: 0;
      right: -40px; /* Početna pozicija izvan desne strane */
    }

    .jump {
      animation: jump 0.5s ease-out;
    }

    @keyframes jump {
      0% { bottom: 0; }
      50% { bottom: 120px; }
      100% { bottom: 0; }
    }

    #gameOver {
      display: none;
      font-size: 24px;
      color: red;
      margin-top: 15px;
    }

    #restartBtn {
      display: none;
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 10px;
      cursor: pointer;
      background-color: #444;
      color: white;
      border: none;
      border-radius: 5px;
      transition: background-color 0.3s ease;
    }

    #restartBtn:hover {
      background-color: #666;
    }

    audio {
      display: none;
    }

    @media (max-width: 850px) {
      #game {
        height: 60vh;
      }

      #player {
        width: 40px;
        height: 40px;
      }

      .obstacle {
        width: 25px;
        height: 25px;
      }

      #score {
        font-size: 16px;
      }

      #gameOver {
        font-size: 20px;
      }

      #restartBtn {
        font-size: 14px;
        padding: 8px 16px;
      }
    }
  </style>
</head>
<body>
  <h2>Dodirni ili pritisni razmak za skok!</h2>
  <div id="score">Rezultat: 0</div>
  <div id="game">
    <div id="player"></div>
  </div>
  <div id="gameOver">💥 Game Over! Pokušaj ponovno.</div>
  <button id="restartBtn">🔁 Restart</button>

  <!-- Zvukovi -->
  <audio id="jumpSound" src="https://freesound.org/data/previews/331/331912_3248244-lq.mp3"></audio>
  <audio id="explosionSound" src="https://freesound.org/data/previews/316/316847_4939433-lq.mp3"></audio>

  <script>
    const game = document.getElementById("game");
    const player = document.getElementById("player");
    const gameOverText = document.getElementById("gameOver");
    const restartBtn = document.getElementById("restartBtn");
    const scoreDisplay = document.getElementById("score");
    const jumpSound = document.getElementById("jumpSound");
    const explosionSound = document.getElementById("explosionSound");

    let isJumping = false;
    let isGameOver = false;
    let score = 0;
    let speed = 3000;
    let obstacleInterval;

    function jump() {
      if (isJumping || isGameOver) return;
      isJumping = true;
      player.classList.add("jump");
      jumpSound.currentTime = 0;
      jumpSound.play();
      setTimeout(() => {
        player.classList.remove("jump");
        isJumping = false;
      }, 500);
    }

    function createObstacle() {
      if (isGameOver) return;

      const obstacle = document.createElement("div");
      obstacle.classList.add("obstacle");
      game.appendChild(obstacle);

      let pos = -40;  // Počinje s desne strane (izvan vidljivog područja)

      const move = setInterval(() => {
        if (isGameOver) {
          clearInterval(move);
          obstacle.remove();
          return;
        }

        pos += 5; // pomičemo bombu ulijevo povećavajući "right" vrijednost
        obstacle.style.right = pos + "px";

        const playerRect = player.getBoundingClientRect();
        const obsRect = obstacle.getBoundingClientRect();

        // Detekcija sudara
        if (
          obsRect.left < playerRect.right &&
          obsRect.right > playerRect.left &&
          obsRect.bottom > playerRect.top &&
          obsRect.top < playerRect.bottom &&
          !isJumping
        ) {
          endGame();
        }

        // Kad bomba izađe s lijeve strane ekrana (tj. "right" > širina igre)
        if (pos > game.offsetWidth + 40) {
          clearInterval(move);
          obstacle.remove();
          score++;
          scoreDisplay.textContent = "Rezultat: " + score;

          if (score % 5 === 0 && speed > 800) {
            speed -= 200;
            clearInterval(obstacleInterval);
            obstacleInterval = setInterval(spawnObstacle, speed);
          }
        }
      }, 20);
    }

    function spawnObstacle() {
      createObstacle();

      // Višestruke bombe nakon 10+ poena
      if (score >= 10 && Math.random() < 0.3) {
        setTimeout(createObstacle, 500);
      }
    }

    function endGame() {
      isGameOver = true;
      explosionSound.currentTime = 0;
      explosionSound.play();
      gameOverText.style.display = "block";
      restartBtn.style.display = "inline-block";
      clearInterval(obstacleInterval);
    }

    restartBtn.onclick = () => {
      location.reload();
    };

    // Kontrole
    document.body.onkeydown = (e) => {
      if (e.code === "Space") jump();
    };
    game.addEventListener("touchstart", jump);

    // Start igre
    obstacleInterval = setInterval(spawnObstacle, speed);
  </script>
</body>
</html>
